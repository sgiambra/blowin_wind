
 make.py started: 2018-05-14 17:12:23 C:\Users\giamb\Documents\GitHub\blowin_wind\derived_local\build_falsification_sample\code 




Execute:  StataMP-64 /e do "./build_falsification.do"

  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   15.0   Copyright 1985-2017 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 32-core Stata perpetual license:
       Serial number:  501506205566
         Licensed to:  KU Leuven FEB (CES)
                       KU Leuven

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do ./build_falsification.do 

. set more off

. adopath + ../../../lib/stata/gslab_misc/ado
  [1]  (BASE)      "C:\Stata15\ado\base/"
  [2]  (SITE)      "C:\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"

. adopath + ../../../lib/third_party/stata_tools
  [1]  (BASE)      "C:\Stata15\ado\base/"
  [2]  (SITE)      "C:\Stata15\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "c:\ado\personal/"
  [5]  (PLUS)      "c:\ado\plus/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "../../../lib/stata/gslab_misc/ado"
  [8]              "../../../lib/third_party/stata_tools"

. preliminaries, loadglob("../../../lib/python/wind/input_params.txt")

. 
. program main
  1.     local farm_threshold 10
  2. 
.     build_false_wind_farms, stub(hazard) time(recdate)
  3.     build_false_wind_farms, stub(notdetermined) time(recdate)
  4.     build_false_wind_farms, stub(nobuiltdate) time(compdate)
  5. 
.     foreach stub in hazard notdetermined nobuiltdate {
  6.         use "${GoogleDrive}/stata/build_wind_panel/wind_panel_zip_fhfa.dta", clear
  7.         bys regionname: egen max_turbines_zip = max(aggr_turb_zip_year)
  8.         keep if max_turbines_zip == 0
  9.         drop wind_farm wind_farm_event
 10.     
.         merge 1:1 regionname year using "../temp/turbines_zip_`stub'.dta", ///
>             assert(1 2 3) keep(1 2 3)
 11.         gen wind_farm = 1 if (_merge == 2 | _merge == 3) & ///
>             aggr_turb_zip_year_`stub' >= `farm_threshold'
 12.         drop _merge
 13.         
.         bysort regionname (year): carryforward aggr_turb_zip_year_`stub' ///
>             wind_farm, replace
 14.         
.         foreach var in new_turb_zip_year_`stub' aggr_turb_zip_year_`stub' wind_farm {
 15.             replace `var' = 0 if `var' == .
 16.         }
 17.         
.         egen wind_farm_event = min(cond(wind_farm == 1, ///
>             year, .)), by(regionname)
 18.         xtset regionname year
 19. 
.         save_data "${GoogleDrive}/stata/build_wind_panel/wind_panel_zip_fhfa_`stub'.dta", ///
>             key(regionname year) replace
 20.     }
 21. end

. 
. program build_false_wind_farms
  1.     syntax, stub(str) time(str)
  2. 
.     import delimited "${GoogleDrive}/gis_derived/zip_turbines_`stub'.csv", clear
  3. 
.     keep objectid_1 `time' zcta5ce10 strtype wsbegdt wsenddt
  4.     keep if !missing(zcta5ce10)
  5. 
.     keep if wsbegdt == "" & wsenddt == ""    
  6.     
.     gen date = date(`time', "YMDhms")
  7.     gen dt = mofd(date)
  8.     format dt %tm
  9.     gen year = year(date)
 10.     keep if year > 1930 & year <= 2018
 11. 
.     drop if strtype != "Wind Turbine"
 12. 
.     collapse (count) new_turb_zip_year_`stub' = objectid_1, by(zcta5ce10 year)
 13.     bys zcta5ce10 (year): gen aggr_turb_zip_year_`stub' = sum(new_turb_zip_year_`stub')
 14.     rename zcta5ce10 regionname
 15.     save_data "../temp/turbines_zip_`stub'.dta", key(regionname year) replace
 16. end

. 
. * Execute
. main
(74 vars, 14,223 obs)
(1,213 observations deleted)
(6,236 observations deleted)
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(8 observations deleted)
(18 observations deleted)
(data already sorted by regionname year)
  variable year was float now int
  variable new_turb_zip_year_hazard was long now int
  variable aggr_turb_zip_year_hazard was float now int
  (3,162 bytes saved)
==================================================================================================
File: ../temp/turbines_zip_hazard.dta
Key: regionname year
==================================================================================================
  527:4(55866):797452300:2195554489

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  regionname |        527    56419.88    28870.84        612      99770
        year |        527    2011.907    3.192328       2003       2017
new_turb_z~d |        527    12.80455    24.18319          1        172
aggr_turb_~d |        527    17.39658    34.17936          1        306




(note: file ../temp/turbines_zip_hazard.dta not found)
file ../temp/turbines_zip_hazard.dta saved
(74 vars, 18,894 obs)
(1,078 observations deleted)
(6,178 observations deleted)
(0 observations deleted)
(451 observations deleted)
(data already sorted by regionname year)
  variable year was float now int
  variable new_turb_zip_year_notdetermined was long now int
  variable aggr_turb_zip_year_notdetermined was float now int
  (2,946 bytes saved)
==================================================================================================
File: ../temp/turbines_zip_notdetermined.dta
Key: regionname year
==================================================================================================
  491:4(64369):963542009:3647317326

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  regionname |        491    64166.39    22874.38        730      99736
        year |        491    2014.884    2.611741       2010       2018
new_turb_z~d |        491    22.78411    35.09535          1        246
aggr_turb_~d |        491    27.76986    43.73219          1        368




(note: file ../temp/turbines_zip_notdetermined.dta not found)
file ../temp/turbines_zip_notdetermined.dta saved
(74 vars, 159,123 obs)
(9,996 observations deleted)
(65,556 observations deleted)
(0 observations deleted)
(5,197 observations deleted)
(data already sorted by regionname year)
  variable year was float now int
  variable new_turb_zip_year_nobuiltdate was long now int
  variable aggr_turb_zip_year_nobuiltdate was float now int
  (20,736 bytes saved)
==================================================================================================
File: ../temp/turbines_zip_nobuiltdate.dta
Key: regionname year
==================================================================================================
  3456:4(54703):1612120559:360676014

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  regionname |      3,456    57324.56     25341.5        603      99783
        year |      3,456     2011.83    3.870428       1999       2018
new_turb_z~e |      3,456    22.67766    36.95834          1        307
aggr_turb_~e |      3,456    48.72454    83.59968          1        830




(note: file ../temp/turbines_zip_nobuiltdate.dta not found)
file ../temp/turbines_zip_nobuiltdate.dta saved
(11,352 observations deleted)

    Result                           # of obs.
    -----------------------------------------
    not matched                       451,167
        from master                   450,847  (_merge==1)
        from using                        320  (_merge==2)

    matched                               207  (_merge==3)
    -----------------------------------------
(451,203 missing values generated)
aggr_turb_zip_year_hazard:  (1,020 real changes made)
wind_farm:  (153 real changes made)
(450,847 real changes made)
(449,827 real changes made)
(451,050 real changes made)
(450361 missing values generated)
       panel variable:  regionname (unbalanced)
        time variable:  year, 1975 to 2017, but with gaps
                delta:  1 unit
(data already sorted by regionname year)
  variable new_turbines_zip_year was int now byte
  variable aggr_turb_zip_year was int now byte
  variable max_turbines_zip was float now byte
  variable wind_farm was float now byte
  variable wind_farm_event was float now int
  (4,513,740 bytes saved)
==================================================================================================
File: G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_hazard.dta
Key: regionname year
==================================================================================================
  451374:23(60009):2044147316:3596013472

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  regionname |    451,374    48104.12    28578.07        612      99770
        year |    451,374    2002.012      10.128       1975       2017
AnnualChange |    431,335    3.448974    7.579811        -60      86.64
         hpi |    451,054    215.0218    159.1692      42.35    2571.26
HPIwith199~e |    275,977    143.1993     62.7227      15.93      830.9
-------------+---------------------------------------------------------
HPIwith200~e |    402,715    107.2663    39.55701          9     471.63
       state |    451,054    28.24464    15.60813          2         56
        ln_p |    451,054    5.215012    .5045662   3.745968   7.852151
new_turbin~r |    451,054           0           0          0          0
aggr_turb_~r |    451,054           0           0          0          0
-------------+---------------------------------------------------------
   zcta5ce10 |    451,054    48095.67    28575.95       1001      99403
       a_zip |    451,054    180.9086    355.4039      .2717    10150.9
tot_wgt_wi~p |    451,054    27.58785    160.3124          0   7285.144
pot_wind_c~a |    451,054    8.456422    20.45832          0   99.77184
new_turb_u~r |    451,054    1447.065    1754.144          0       5436
-------------+---------------------------------------------------------
new_turb_r~r |    451,054    1447.065    1754.144          0       5436
subvention~p |    451,054    14346.22    54124.62          0   542359.8
first_us_t~p |    451,054    6.128857    18.31483          0   99.77184
max_turbin~p |    451,054           0           0          0          0
new_turb_z~d |    451,374    .0149499    .9341959          0        172
-------------+---------------------------------------------------------
aggr_turb_~d |    451,374    .0351815    1.497428          0        306
   wind_farm |    451,374    .0007178    .0267824          0          1
wind_farm_~t |      1,013     2011.92    2.584257       2006       2017




(note: file G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_hazard.dta not found)
file G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_hazard.dta saved
(11,352 observations deleted)

    Result                           # of obs.
    -----------------------------------------
    not matched                       451,363
        from master                   450,963  (_merge==1)
        from using                        400  (_merge==2)

    matched                                91  (_merge==3)
    -----------------------------------------
(451,214 missing values generated)
aggr_turb_zip_year_notdetermined:  (236 real changes made)
wind_farm:  (43 real changes made)
(450,963 real changes made)
(450,727 real changes made)
(451,171 real changes made)
(450489 missing values generated)
       panel variable:  regionname (unbalanced)
        time variable:  year, 1975 to 2018, but with gaps
                delta:  1 unit
(data already sorted by regionname year)
  variable new_turbines_zip_year was int now byte
  variable aggr_turb_zip_year was int now byte
  variable max_turbines_zip was float now byte
  variable wind_farm was float now byte
  variable wind_farm_event was float now int
  (4,514,540 bytes saved)
==================================================================================================
File: G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_notdetermined.dta
Key: regionname year
==================================================================================================
  451454:23(68510):2773676272:2172413964

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  regionname |    451,454    48111.94    28574.97        730      99736
        year |    451,454    2002.016    10.13085       1975       2018
AnnualChange |    431,335    3.448974    7.579811        -60      86.64
         hpi |    451,054    215.0218    159.1692      42.35    2571.26
HPIwith199~e |    275,977    143.1993     62.7227      15.93      830.9
-------------+---------------------------------------------------------
HPIwith200~e |    402,715    107.2663    39.55701          9     471.63
       state |    451,054    28.24464    15.60813          2         56
        ln_p |    451,054    5.215012    .5045662   3.745968   7.852151
new_turbin~r |    451,054           0           0          0          0
aggr_turb_~r |    451,054           0           0          0          0
-------------+---------------------------------------------------------
   zcta5ce10 |    451,054    48095.67    28575.95       1001      99403
       a_zip |    451,054    180.9086    355.4039      .2717    10150.9
tot_wgt_wi~p |    451,054    27.58785    160.3124          0   7285.144
pot_wind_c~a |    451,054    8.456422    20.45832          0   99.77184
new_turb_u~r |    451,054    1447.065    1754.144          0       5436
-------------+---------------------------------------------------------
new_turb_r~r |    451,054    1447.065    1754.144          0       5436
subvention~p |    451,054    14346.22    54124.62          0   542359.8
first_us_t~p |    451,054    6.128857    18.31483          0   99.77184
max_turbin~p |    451,054           0           0          0          0
new_turb_z~d |    451,454    .0247799    1.378705          0        246
-------------+---------------------------------------------------------
aggr_turb_~d |    451,454    .0341009    1.735646          0        368
   wind_farm |    451,454    .0006269    .0250294          0          1
wind_farm_~t |        965    2015.437    2.321525       2010       2018




(note: file G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_notdetermined.dta not found)
file G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_notdetermined.dta saved
(11,352 observations deleted)

    Result                           # of obs.
    -----------------------------------------
    not matched                       452,686
        from master                   450,142  (_merge==1)
        from using                      2,544  (_merge==2)

    matched                               912  (_merge==3)
    -----------------------------------------
(451,596 missing values generated)
aggr_turb_zip_year_nobuiltdate:  (4,269 real changes made)
wind_farm:  (788 real changes made)
(450,142 real changes made)
(445,873 real changes made)
(450,808 real changes made)
(446641 missing values generated)
       panel variable:  regionname (unbalanced)
        time variable:  year, 1975 to 2018, but with gaps
                delta:  1 unit
(data already sorted by regionname year)
  variable new_turbines_zip_year was int now byte
  variable aggr_turb_zip_year was int now byte
  variable max_turbines_zip was float now byte
  variable wind_farm was float now byte
  variable wind_farm_event was float now int
  (4,535,980 bytes saved)
==================================================================================================
File: G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_nobuiltdate.dta
Key: regionname year
==================================================================================================
  453598:23(82907):1029191625:2907239289

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  regionname |    453,598    48165.69    28569.32        603      99783
        year |    453,598    2002.062    10.13179       1975       2018
AnnualChange |    431,335    3.448974    7.579811        -60      86.64
         hpi |    451,054    215.0218    159.1692      42.35    2571.26
HPIwith199~e |    275,977    143.1993     62.7227      15.93      830.9
-------------+---------------------------------------------------------
HPIwith200~e |    402,715    107.2663    39.55701          9     471.63
       state |    451,054    28.24464    15.60813          2         56
        ln_p |    451,054    5.215012    .5045662   3.745968   7.852151
new_turbin~r |    451,054           0           0          0          0
aggr_turb_~r |    451,054           0           0          0          0
-------------+---------------------------------------------------------
   zcta5ce10 |    451,054    48095.67    28575.95       1001      99403
       a_zip |    451,054    180.9086    355.4039      .2717    10150.9
tot_wgt_wi~p |    451,054    27.58785    160.3124          0   7285.144
pot_wind_c~a |    451,054    8.456422    20.45832          0   99.77184
new_turb_u~r |    451,054    1447.065    1754.144          0       5436
-------------+---------------------------------------------------------
new_turb_r~r |    451,054    1447.065    1754.144          0       5436
subvention~p |    451,054    14346.22    54124.62          0   542359.8
first_us_t~p |    451,054    6.128857    18.31483          0   99.77184
max_turbin~p |    451,054           0           0          0          0
new_turb_z~e |    453,598    .1727829    3.780546          0        307
-------------+---------------------------------------------------------
aggr_turb_~e |    453,598    .4558816    8.745514          0        830
   wind_farm |    453,598    .0061508    .0781857          0          1
wind_farm_~t |      6,957    2011.964    3.255157       2000       2018




(note: file G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_nobuiltdate.dta not found)
file G:/My Drive/research projects/wind/stata/build_wind_panel/wind_panel_zip_fhfa_nobuiltdate.dta saved

. 
end of do-file

 make.py ended: 2018-05-14 17:13:16
